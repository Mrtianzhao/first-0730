<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.dgg.cloud.dao.XdResourcesBaseMapper">
    <resultMap id="BaseResultMap" type="net.dgg.cloud.entity.XdResourcesBase">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="resources_id" jdbcType="VARCHAR" property="resourcesId" />
        <result column="business_code" jdbcType="VARCHAR" property="businessCode" />
        <result column="customer_name" jdbcType="VARCHAR" property="customerName" />
        <result column="customer_phone" jdbcType="VARCHAR" property="customerPhone" />
        <result column="customer_sex" jdbcType="INTEGER" property="customerSex" />
        <result column="big_biz_id" jdbcType="VARCHAR" property="bigBizId" />
        <result column="operation_type_id" jdbcType="VARCHAR" property="operationTypeId" />
        <result column="province" jdbcType="VARCHAR" property="province" />
        <result column="visit_city" jdbcType="VARCHAR" property="visitCity" />
        <result column="customer_address" jdbcType="VARCHAR" property="customerAddress" />
        <result column="visit_address" jdbcType="VARCHAR" property="visitAddress" />
        <result column="consulting_time" jdbcType="TIMESTAMP" property="consultingTime" />
        <result column="subscribe_time" jdbcType="TIMESTAMP" property="subscribeTime" />
        <result column="message" jdbcType="VARCHAR" property="message" />
        <result column="cmt" jdbcType="VARCHAR" property="cmt" />
        <result column="resource_channel" jdbcType="INTEGER" property="resourceChannel" />
        <result column="resources_status" jdbcType="INTEGER" property="resourcesStatus" />
        <result column="lost_time" jdbcType="TIMESTAMP" property="lostTime" />
        <result column="lost_type" jdbcType="INTEGER" property="lostType" />
        <result column="lost_state" jdbcType="INTEGER" property="lostState" />
        <result column="lost_display_time" jdbcType="TIMESTAMP" property="lostDisplayTime" />
        <result column="lost_user_id" jdbcType="VARCHAR" property="lostUserId" />
        <result column="invalid_num" jdbcType="INTEGER" property="invalidNum" />
        <result column="invalid_time" jdbcType="TIMESTAMP" property="invalidTime" />
        <result column="reason" jdbcType="VARCHAR" property="reason" />
        <result column="place_time" jdbcType="TIMESTAMP" property="placeTime" />
        <result column="f_order_time" jdbcType="TIMESTAMP" property="fOrderTime" />
        <result column="assigner_user_id" jdbcType="VARCHAR" property="assignerUserId" />
        <result column="assigner_user_name" jdbcType="VARCHAR" property="assignerUserName" />
        <result column="assigner_user_workno" jdbcType="VARCHAR" property="assignerUserWorkno" />
        <result column="assigner_time" jdbcType="TIMESTAMP" property="assignerTime" />
        <result column="es_re_time" jdbcType="TIMESTAMP" property="esReTime" />
        <result column="next_follow_time" jdbcType="TIMESTAMP" property="nextFollowTime" />
        <result column="first_user_id" jdbcType="VARCHAR" property="firstUserId" />
        <result column="first_time" jdbcType="TIMESTAMP" property="firstTime" />
        <result column="resources_cost" jdbcType="INTEGER" property="resourcesCost" />
        <result column="is_cost" jdbcType="INTEGER" property="isCost" />
        <result column="commerce_id" jdbcType="VARCHAR" property="commerceId" />
        <result column="create_user_id" jdbcType="VARCHAR" property="createUserId" />
        <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
        <result column="update_user_id" jdbcType="VARCHAR" property="updateUserId" />
        <result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
        <result column="del_flag" jdbcType="INTEGER" property="delFlag" />
        <result column="is_push" jdbcType="INTEGER" property="isPush" />
        <result column="invalid_source" jdbcType="INTEGER" property="invalidSource" />
        <result column="longitude" jdbcType="VARCHAR" property="longitude" />
        <result column="latitude" jdbcType="VARCHAR" property="latitude" />
        <result column="channel_source" jdbcType="INTEGER" property="channelSource" />
        <result column="order_op_name" jdbcType="VARCHAR" property="orderOpName" />
        <result column="order_op_number" jdbcType="VARCHAR" property="orderOpNumber" />
        <result column="res_source_id" jdbcType="VARCHAR" property="resSourceId" />
        <result column="auto_dis_num" jdbcType="INTEGER" property="autoDisNum" />
        <result column="ext_business_code" jdbcType="VARCHAR" property="extBusinessCode" />
        <result column="current_visit_id" jdbcType="VARCHAR" property="currentVisitId" />
        <result column="last_follow_time" jdbcType="TIMESTAMP" property="lastFollowTime" />
        <result column="last_visit_time" jdbcType="TIMESTAMP" property="lastVisitTime" />
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        resources_id, business_code, customer_name, customer_phone, customer_sex, big_biz_id,
        operation_type_id, province, visit_city, customer_address, visit_address, consulting_time,
        subscribe_time, message, cmt, resource_channel, resources_status, lost_time, lost_type,
        lost_state, lost_display_time, lost_user_id, invalid_num, invalid_time, reason, place_time,
        f_order_time, assigner_user_id, assigner_user_name, assigner_user_workno, assigner_time,
        es_re_time, next_follow_time, first_user_id, first_time, resources_cost, is_cost,
        commerce_id, create_user_id, create_time, update_user_id, update_time, del_flag,
        is_push, invalid_source, longitude, latitude, channel_source, order_op_name, order_op_number,
        res_source_id, auto_dis_num, ext_business_code, current_visit_id, last_follow_time,
        last_visit_time
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List" />
        from xd_resources_base
        where resources_id = #{resourcesId,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from xd_resources_base
        where resources_id = #{resourcesId,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" parameterType="net.dgg.cloud.entity.XdResourcesBase">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into xd_resources_base (resources_id, business_code, customer_name,
        customer_phone, customer_sex, big_biz_id,
        operation_type_id, province, visit_city,
        customer_address, visit_address, consulting_time,
        subscribe_time, message, cmt,
        resource_channel, resources_status, lost_time,
        lost_type, lost_state, lost_display_time,
        lost_user_id, invalid_num, invalid_time,
        reason, place_time, f_order_time,
        assigner_user_id, assigner_user_name, assigner_user_workno,
        assigner_time, es_re_time, next_follow_time,
        first_user_id, first_time, resources_cost,
        is_cost, commerce_id, create_user_id,
        create_time, update_user_id, update_time,
        del_flag, is_push, invalid_source,
        longitude, latitude, channel_source,
        order_op_name, order_op_number, res_source_id,
        auto_dis_num, ext_business_code, current_visit_id,
        last_follow_time, last_visit_time)
        values (#{resourcesId,jdbcType=VARCHAR}, #{businessCode,jdbcType=VARCHAR}, #{customerName,jdbcType=VARCHAR},
        #{customerPhone,jdbcType=VARCHAR}, #{customerSex,jdbcType=INTEGER}, #{bigBizId,jdbcType=VARCHAR},
        #{operationTypeId,jdbcType=VARCHAR}, #{province,jdbcType=VARCHAR}, #{visitCity,jdbcType=VARCHAR},
        #{customerAddress,jdbcType=VARCHAR}, #{visitAddress,jdbcType=VARCHAR}, #{consultingTime,jdbcType=TIMESTAMP},
        #{subscribeTime,jdbcType=TIMESTAMP}, #{message,jdbcType=VARCHAR}, #{cmt,jdbcType=VARCHAR},
        #{resourceChannel,jdbcType=INTEGER}, #{resourcesStatus,jdbcType=INTEGER}, #{lostTime,jdbcType=TIMESTAMP},
        #{lostType,jdbcType=INTEGER}, #{lostState,jdbcType=INTEGER}, #{lostDisplayTime,jdbcType=TIMESTAMP},
        #{lostUserId,jdbcType=VARCHAR}, #{invalidNum,jdbcType=INTEGER}, #{invalidTime,jdbcType=TIMESTAMP},
        #{reason,jdbcType=VARCHAR}, #{placeTime,jdbcType=TIMESTAMP}, #{fOrderTime,jdbcType=TIMESTAMP},
        #{assignerUserId,jdbcType=VARCHAR}, #{assignerUserName,jdbcType=VARCHAR}, #{assignerUserWorkno,jdbcType=VARCHAR},
        #{assignerTime,jdbcType=TIMESTAMP}, #{esReTime,jdbcType=TIMESTAMP}, #{nextFollowTime,jdbcType=TIMESTAMP},
        #{firstUserId,jdbcType=VARCHAR}, #{firstTime,jdbcType=TIMESTAMP}, #{resourcesCost,jdbcType=INTEGER},
        #{isCost,jdbcType=INTEGER}, #{commerceId,jdbcType=VARCHAR}, #{createUserId,jdbcType=VARCHAR},
        #{createTime,jdbcType=TIMESTAMP}, #{updateUserId,jdbcType=VARCHAR}, #{updateTime,jdbcType=TIMESTAMP},
        #{delFlag,jdbcType=INTEGER}, #{isPush,jdbcType=INTEGER}, #{invalidSource,jdbcType=INTEGER},
        #{longitude,jdbcType=VARCHAR}, #{latitude,jdbcType=VARCHAR}, #{channelSource,jdbcType=INTEGER},
        #{orderOpName,jdbcType=VARCHAR}, #{orderOpNumber,jdbcType=VARCHAR}, #{resSourceId,jdbcType=VARCHAR},
        #{autoDisNum,jdbcType=INTEGER}, #{extBusinessCode,jdbcType=VARCHAR}, #{currentVisitId,jdbcType=VARCHAR},
        #{lastFollowTime,jdbcType=TIMESTAMP}, #{lastVisitTime,jdbcType=TIMESTAMP})
    </insert>
    <insert id="insertSelective" parameterType="net.dgg.cloud.entity.XdResourcesBase">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into xd_resources_base
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="resourcesId != null">
                resources_id,
            </if>
            <if test="businessCode != null">
                business_code,
            </if>
            <if test="customerName != null">
                customer_name,
            </if>
            <if test="customerPhone != null">
                customer_phone,
            </if>
            <if test="customerSex != null">
                customer_sex,
            </if>
            <if test="bigBizId != null">
                big_biz_id,
            </if>
            <if test="operationTypeId != null">
                operation_type_id,
            </if>
            <if test="province != null">
                province,
            </if>
            <if test="visitCity != null">
                visit_city,
            </if>
            <if test="customerAddress != null">
                customer_address,
            </if>
            <if test="visitAddress != null">
                visit_address,
            </if>
            <if test="consultingTime != null">
                consulting_time,
            </if>
            <if test="subscribeTime != null">
                subscribe_time,
            </if>
            <if test="message != null">
                message,
            </if>
            <if test="cmt != null">
                cmt,
            </if>
            <if test="resourceChannel != null">
                resource_channel,
            </if>
            <if test="resourcesStatus != null">
                resources_status,
            </if>
            <if test="lostTime != null">
                lost_time,
            </if>
            <if test="lostType != null">
                lost_type,
            </if>
            <if test="lostState != null">
                lost_state,
            </if>
            <if test="lostDisplayTime != null">
                lost_display_time,
            </if>
            <if test="lostUserId != null">
                lost_user_id,
            </if>
            <if test="invalidNum != null">
                invalid_num,
            </if>
            <if test="invalidTime != null">
                invalid_time,
            </if>
            <if test="reason != null">
                reason,
            </if>
            <if test="placeTime != null">
                place_time,
            </if>
            <if test="fOrderTime != null">
                f_order_time,
            </if>
            <if test="assignerUserId != null">
                assigner_user_id,
            </if>
            <if test="assignerUserName != null">
                assigner_user_name,
            </if>
            <if test="assignerUserWorkno != null">
                assigner_user_workno,
            </if>
            <if test="assignerTime != null">
                assigner_time,
            </if>
            <if test="esReTime != null">
                es_re_time,
            </if>
            <if test="nextFollowTime != null">
                next_follow_time,
            </if>
            <if test="firstUserId != null">
                first_user_id,
            </if>
            <if test="firstTime != null">
                first_time,
            </if>
            <if test="resourcesCost != null">
                resources_cost,
            </if>
            <if test="isCost != null">
                is_cost,
            </if>
            <if test="commerceId != null">
                commerce_id,
            </if>
            <if test="createUserId != null">
                create_user_id,
            </if>
            <if test="createTime != null">
                create_time,
            </if>
            <if test="updateUserId != null">
                update_user_id,
            </if>
            <if test="updateTime != null">
                update_time,
            </if>
            <if test="delFlag != null">
                del_flag,
            </if>
            <if test="isPush != null">
                is_push,
            </if>
            <if test="invalidSource != null">
                invalid_source,
            </if>
            <if test="longitude != null">
                longitude,
            </if>
            <if test="latitude != null">
                latitude,
            </if>
            <if test="channelSource != null">
                channel_source,
            </if>
            <if test="orderOpName != null">
                order_op_name,
            </if>
            <if test="orderOpNumber != null">
                order_op_number,
            </if>
            <if test="resSourceId != null">
                res_source_id,
            </if>
            <if test="autoDisNum != null">
                auto_dis_num,
            </if>
            <if test="extBusinessCode != null">
                ext_business_code,
            </if>
            <if test="currentVisitId != null">
                current_visit_id,
            </if>
            <if test="lastFollowTime != null">
                last_follow_time,
            </if>
            <if test="lastVisitTime != null">
                last_visit_time,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="resourcesId != null">
                #{resourcesId,jdbcType=VARCHAR},
            </if>
            <if test="businessCode != null">
                #{businessCode,jdbcType=VARCHAR},
            </if>
            <if test="customerName != null">
                #{customerName,jdbcType=VARCHAR},
            </if>
            <if test="customerPhone != null">
                #{customerPhone,jdbcType=VARCHAR},
            </if>
            <if test="customerSex != null">
                #{customerSex,jdbcType=INTEGER},
            </if>
            <if test="bigBizId != null">
                #{bigBizId,jdbcType=VARCHAR},
            </if>
            <if test="operationTypeId != null">
                #{operationTypeId,jdbcType=VARCHAR},
            </if>
            <if test="province != null">
                #{province,jdbcType=VARCHAR},
            </if>
            <if test="visitCity != null">
                #{visitCity,jdbcType=VARCHAR},
            </if>
            <if test="customerAddress != null">
                #{customerAddress,jdbcType=VARCHAR},
            </if>
            <if test="visitAddress != null">
                #{visitAddress,jdbcType=VARCHAR},
            </if>
            <if test="consultingTime != null">
                #{consultingTime,jdbcType=TIMESTAMP},
            </if>
            <if test="subscribeTime != null">
                #{subscribeTime,jdbcType=TIMESTAMP},
            </if>
            <if test="message != null">
                #{message,jdbcType=VARCHAR},
            </if>
            <if test="cmt != null">
                #{cmt,jdbcType=VARCHAR},
            </if>
            <if test="resourceChannel != null">
                #{resourceChannel,jdbcType=INTEGER},
            </if>
            <if test="resourcesStatus != null">
                #{resourcesStatus,jdbcType=INTEGER},
            </if>
            <if test="lostTime != null">
                #{lostTime,jdbcType=TIMESTAMP},
            </if>
            <if test="lostType != null">
                #{lostType,jdbcType=INTEGER},
            </if>
            <if test="lostState != null">
                #{lostState,jdbcType=INTEGER},
            </if>
            <if test="lostDisplayTime != null">
                #{lostDisplayTime,jdbcType=TIMESTAMP},
            </if>
            <if test="lostUserId != null">
                #{lostUserId,jdbcType=VARCHAR},
            </if>
            <if test="invalidNum != null">
                #{invalidNum,jdbcType=INTEGER},
            </if>
            <if test="invalidTime != null">
                #{invalidTime,jdbcType=TIMESTAMP},
            </if>
            <if test="reason != null">
                #{reason,jdbcType=VARCHAR},
            </if>
            <if test="placeTime != null">
                #{placeTime,jdbcType=TIMESTAMP},
            </if>
            <if test="fOrderTime != null">
                #{fOrderTime,jdbcType=TIMESTAMP},
            </if>
            <if test="assignerUserId != null">
                #{assignerUserId,jdbcType=VARCHAR},
            </if>
            <if test="assignerUserName != null">
                #{assignerUserName,jdbcType=VARCHAR},
            </if>
            <if test="assignerUserWorkno != null">
                #{assignerUserWorkno,jdbcType=VARCHAR},
            </if>
            <if test="assignerTime != null">
                #{assignerTime,jdbcType=TIMESTAMP},
            </if>
            <if test="esReTime != null">
                #{esReTime,jdbcType=TIMESTAMP},
            </if>
            <if test="nextFollowTime != null">
                #{nextFollowTime,jdbcType=TIMESTAMP},
            </if>
            <if test="firstUserId != null">
                #{firstUserId,jdbcType=VARCHAR},
            </if>
            <if test="firstTime != null">
                #{firstTime,jdbcType=TIMESTAMP},
            </if>
            <if test="resourcesCost != null">
                #{resourcesCost,jdbcType=INTEGER},
            </if>
            <if test="isCost != null">
                #{isCost,jdbcType=INTEGER},
            </if>
            <if test="commerceId != null">
                #{commerceId,jdbcType=VARCHAR},
            </if>
            <if test="createUserId != null">
                #{createUserId,jdbcType=VARCHAR},
            </if>
            <if test="createTime != null">
                #{createTime,jdbcType=TIMESTAMP},
            </if>
            <if test="updateUserId != null">
                #{updateUserId,jdbcType=VARCHAR},
            </if>
            <if test="updateTime != null">
                #{updateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="delFlag != null">
                #{delFlag,jdbcType=INTEGER},
            </if>
            <if test="isPush != null">
                #{isPush,jdbcType=INTEGER},
            </if>
            <if test="invalidSource != null">
                #{invalidSource,jdbcType=INTEGER},
            </if>
            <if test="longitude != null">
                #{longitude,jdbcType=VARCHAR},
            </if>
            <if test="latitude != null">
                #{latitude,jdbcType=VARCHAR},
            </if>
            <if test="channelSource != null">
                #{channelSource,jdbcType=INTEGER},
            </if>
            <if test="orderOpName != null">
                #{orderOpName,jdbcType=VARCHAR},
            </if>
            <if test="orderOpNumber != null">
                #{orderOpNumber,jdbcType=VARCHAR},
            </if>
            <if test="resSourceId != null">
                #{resSourceId,jdbcType=VARCHAR},
            </if>
            <if test="autoDisNum != null">
                #{autoDisNum,jdbcType=INTEGER},
            </if>
            <if test="extBusinessCode != null">
                #{extBusinessCode,jdbcType=VARCHAR},
            </if>
            <if test="currentVisitId != null">
                #{currentVisitId,jdbcType=VARCHAR},
            </if>
            <if test="lastFollowTime != null">
                #{lastFollowTime,jdbcType=TIMESTAMP},
            </if>
            <if test="lastVisitTime != null">
                #{lastVisitTime,jdbcType=TIMESTAMP},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="net.dgg.cloud.entity.XdResourcesBase">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update xd_resources_base
        <set>
            <if test="businessCode != null">
                business_code = #{businessCode,jdbcType=VARCHAR},
            </if>
            <if test="customerName != null">
                customer_name = #{customerName,jdbcType=VARCHAR},
            </if>
            <if test="customerPhone != null">
                customer_phone = #{customerPhone,jdbcType=VARCHAR},
            </if>
            <if test="customerSex != null">
                customer_sex = #{customerSex,jdbcType=INTEGER},
            </if>
            <if test="bigBizId != null">
                big_biz_id = #{bigBizId,jdbcType=VARCHAR},
            </if>
            <if test="operationTypeId != null">
                operation_type_id = #{operationTypeId,jdbcType=VARCHAR},
            </if>
            <if test="province != null">
                province = #{province,jdbcType=VARCHAR},
            </if>
            <if test="visitCity != null">
                visit_city = #{visitCity,jdbcType=VARCHAR},
            </if>
            <if test="customerAddress != null">
                customer_address = #{customerAddress,jdbcType=VARCHAR},
            </if>
            <if test="visitAddress != null">
                visit_address = #{visitAddress,jdbcType=VARCHAR},
            </if>
            <if test="consultingTime != null">
                consulting_time = #{consultingTime,jdbcType=TIMESTAMP},
            </if>
            <if test="subscribeTime != null">
                subscribe_time = #{subscribeTime,jdbcType=TIMESTAMP},
            </if>
            <if test="message != null">
                message = #{message,jdbcType=VARCHAR},
            </if>
            <if test="cmt != null">
                cmt = #{cmt,jdbcType=VARCHAR},
            </if>
            <if test="resourceChannel != null">
                resource_channel = #{resourceChannel,jdbcType=INTEGER},
            </if>
            <if test="resourcesStatus != null">
                resources_status = #{resourcesStatus,jdbcType=INTEGER},
            </if>
            <if test="lostTime != null">
                lost_time = #{lostTime,jdbcType=TIMESTAMP},
            </if>
            <if test="lostType != null">
                lost_type = #{lostType,jdbcType=INTEGER},
            </if>
            <if test="lostState != null">
                lost_state = #{lostState,jdbcType=INTEGER},
            </if>
            <if test="lostDisplayTime != null">
                lost_display_time = #{lostDisplayTime,jdbcType=TIMESTAMP},
            </if>
            <if test="lostUserId != null">
                lost_user_id = #{lostUserId,jdbcType=VARCHAR},
            </if>
            <if test="invalidNum != null">
                invalid_num = #{invalidNum,jdbcType=INTEGER},
            </if>
            <if test="invalidTime != null">
                invalid_time = #{invalidTime,jdbcType=TIMESTAMP},
            </if>
            <if test="reason != null">
                reason = #{reason,jdbcType=VARCHAR},
            </if>
            <if test="placeTime != null">
                place_time = #{placeTime,jdbcType=TIMESTAMP},
            </if>
            <if test="fOrderTime != null">
                f_order_time = #{fOrderTime,jdbcType=TIMESTAMP},
            </if>
            <if test="assignerUserId != null">
                assigner_user_id = #{assignerUserId,jdbcType=VARCHAR},
            </if>
            <if test="assignerUserName != null">
                assigner_user_name = #{assignerUserName,jdbcType=VARCHAR},
            </if>
            <if test="assignerUserWorkno != null">
                assigner_user_workno = #{assignerUserWorkno,jdbcType=VARCHAR},
            </if>
            <if test="assignerTime != null">
                assigner_time = #{assignerTime,jdbcType=TIMESTAMP},
            </if>
            <if test="esReTime != null">
                es_re_time = #{esReTime,jdbcType=TIMESTAMP},
            </if>
            <if test="nextFollowTime != null">
                next_follow_time = #{nextFollowTime,jdbcType=TIMESTAMP},
            </if>
            <if test="firstUserId != null">
                first_user_id = #{firstUserId,jdbcType=VARCHAR},
            </if>
            <if test="firstTime != null">
                first_time = #{firstTime,jdbcType=TIMESTAMP},
            </if>
            <if test="resourcesCost != null">
                resources_cost = #{resourcesCost,jdbcType=INTEGER},
            </if>
            <if test="isCost != null">
                is_cost = #{isCost,jdbcType=INTEGER},
            </if>
            <if test="commerceId != null">
                commerce_id = #{commerceId,jdbcType=VARCHAR},
            </if>
            <if test="createUserId != null">
                create_user_id = #{createUserId,jdbcType=VARCHAR},
            </if>
            <if test="createTime != null">
                create_time = #{createTime,jdbcType=TIMESTAMP},
            </if>
            <if test="updateUserId != null">
                update_user_id = #{updateUserId,jdbcType=VARCHAR},
            </if>
            <if test="updateTime != null">
                update_time = #{updateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="delFlag != null">
                del_flag = #{delFlag,jdbcType=INTEGER},
            </if>
            <if test="isPush != null">
                is_push = #{isPush,jdbcType=INTEGER},
            </if>
            <if test="invalidSource != null">
                invalid_source = #{invalidSource,jdbcType=INTEGER},
            </if>
            <if test="longitude != null">
                longitude = #{longitude,jdbcType=VARCHAR},
            </if>
            <if test="latitude != null">
                latitude = #{latitude,jdbcType=VARCHAR},
            </if>
            <if test="channelSource != null">
                channel_source = #{channelSource,jdbcType=INTEGER},
            </if>
            <if test="orderOpName != null">
                order_op_name = #{orderOpName,jdbcType=VARCHAR},
            </if>
            <if test="orderOpNumber != null">
                order_op_number = #{orderOpNumber,jdbcType=VARCHAR},
            </if>
            <if test="resSourceId != null">
                res_source_id = #{resSourceId,jdbcType=VARCHAR},
            </if>
            <if test="autoDisNum != null">
                auto_dis_num = #{autoDisNum,jdbcType=INTEGER},
            </if>
            <if test="extBusinessCode != null">
                ext_business_code = #{extBusinessCode,jdbcType=VARCHAR},
            </if>
            <if test="currentVisitId != null">
                current_visit_id = #{currentVisitId,jdbcType=VARCHAR},
            </if>
            <if test="lastFollowTime != null">
                last_follow_time = #{lastFollowTime,jdbcType=TIMESTAMP},
            </if>
            <if test="lastVisitTime != null">
                last_visit_time = #{lastVisitTime,jdbcType=TIMESTAMP},
            </if>
        </set>
        where resources_id = #{resourcesId,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="net.dgg.cloud.entity.XdResourcesBase">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update xd_resources_base
        set business_code = #{businessCode,jdbcType=VARCHAR},
        customer_name = #{customerName,jdbcType=VARCHAR},
        customer_phone = #{customerPhone,jdbcType=VARCHAR},
        customer_sex = #{customerSex,jdbcType=INTEGER},
        big_biz_id = #{bigBizId,jdbcType=VARCHAR},
        operation_type_id = #{operationTypeId,jdbcType=VARCHAR},
        province = #{province,jdbcType=VARCHAR},
        visit_city = #{visitCity,jdbcType=VARCHAR},
        customer_address = #{customerAddress,jdbcType=VARCHAR},
        visit_address = #{visitAddress,jdbcType=VARCHAR},
        consulting_time = #{consultingTime,jdbcType=TIMESTAMP},
        subscribe_time = #{subscribeTime,jdbcType=TIMESTAMP},
        message = #{message,jdbcType=VARCHAR},
        cmt = #{cmt,jdbcType=VARCHAR},
        resource_channel = #{resourceChannel,jdbcType=INTEGER},
        resources_status = #{resourcesStatus,jdbcType=INTEGER},
        lost_time = #{lostTime,jdbcType=TIMESTAMP},
        lost_type = #{lostType,jdbcType=INTEGER},
        lost_state = #{lostState,jdbcType=INTEGER},
        lost_display_time = #{lostDisplayTime,jdbcType=TIMESTAMP},
        lost_user_id = #{lostUserId,jdbcType=VARCHAR},
        invalid_num = #{invalidNum,jdbcType=INTEGER},
        invalid_time = #{invalidTime,jdbcType=TIMESTAMP},
        reason = #{reason,jdbcType=VARCHAR},
        place_time = #{placeTime,jdbcType=TIMESTAMP},
        f_order_time = #{fOrderTime,jdbcType=TIMESTAMP},
        assigner_user_id = #{assignerUserId,jdbcType=VARCHAR},
        assigner_user_name = #{assignerUserName,jdbcType=VARCHAR},
        assigner_user_workno = #{assignerUserWorkno,jdbcType=VARCHAR},
        assigner_time = #{assignerTime,jdbcType=TIMESTAMP},
        es_re_time = #{esReTime,jdbcType=TIMESTAMP},
        next_follow_time = #{nextFollowTime,jdbcType=TIMESTAMP},
        first_user_id = #{firstUserId,jdbcType=VARCHAR},
        first_time = #{firstTime,jdbcType=TIMESTAMP},
        resources_cost = #{resourcesCost,jdbcType=INTEGER},
        is_cost = #{isCost,jdbcType=INTEGER},
        commerce_id = #{commerceId,jdbcType=VARCHAR},
        create_user_id = #{createUserId,jdbcType=VARCHAR},
        create_time = #{createTime,jdbcType=TIMESTAMP},
        update_user_id = #{updateUserId,jdbcType=VARCHAR},
        update_time = #{updateTime,jdbcType=TIMESTAMP},
        del_flag = #{delFlag,jdbcType=INTEGER},
        is_push = #{isPush,jdbcType=INTEGER},
        invalid_source = #{invalidSource,jdbcType=INTEGER},
        longitude = #{longitude,jdbcType=VARCHAR},
        latitude = #{latitude,jdbcType=VARCHAR},
        channel_source = #{channelSource,jdbcType=INTEGER},
        order_op_name = #{orderOpName,jdbcType=VARCHAR},
        order_op_number = #{orderOpNumber,jdbcType=VARCHAR},
        res_source_id = #{resSourceId,jdbcType=VARCHAR},
        auto_dis_num = #{autoDisNum,jdbcType=INTEGER},
        ext_business_code = #{extBusinessCode,jdbcType=VARCHAR},
        current_visit_id = #{currentVisitId,jdbcType=VARCHAR},
        last_follow_time = #{lastFollowTime,jdbcType=TIMESTAMP},
        last_visit_time = #{lastVisitTime,jdbcType=TIMESTAMP}
        where resources_id = #{resourcesId,jdbcType=VARCHAR}
    </update>

    <!-- 剔除资源 -->
    <update id="updateByLostType" parameterType="net.dgg.cloud.entity.XdResourcesBase">
    update xd_resources_base
    set
    lost_type = 0,
    create_user_id = #{createUserId,jdbcType=VARCHAR},
    create_time = #{createTime,jdbcType=TIMESTAMP},
    update_user_id = #{updateUserId,jdbcType=VARCHAR},
    update_time = #{updateTime,jdbcType=TIMESTAMP}
    where resources_id = #{resourcesId,jdbcType=VARCHAR}
  </update>

    <!-- 反无效资源 -->
    <update id="updateByResourcesStatus" parameterType="net.dgg.cloud.entity.XdResourcesBase">
    update xd_resources_base
    set
    resources_status = 7,
    create_user_id = #{createUserId,jdbcType=VARCHAR},
    create_time = #{createTime,jdbcType=TIMESTAMP},
    update_user_id = #{updateUserId,jdbcType=VARCHAR},
    update_time = #{updateTime,jdbcType=TIMESTAMP}
    where resources_id = #{resourcesId,jdbcType=VARCHAR}
  </update>

    <!-- 查询资源信息列表 -->
    <select id="selectResourcesBaseList" resultMap="ResultMap" parameterType="net.dgg.cloud.dto.XdResourcesBaseDto">
        select
        <include refid="Column_List"/>
        from xd_resources_base t1
        LEFT JOIN con_region t2 ON t1.visit_city =t2.id
        LEFT JOIN xd_business t3 ON t1.operation_type_id=t3.id
        LEFT JOIN xd_resources_status t4 ON t1.resources_status=t4.resource_status
        LEFT JOIN xd_resources_lostype t5 ON t1.lost_type=t5.lost_id
        LEFT JOIN xd_resource_source t7 ON t1.res_source_id = t7.id
        <if test="searchKey != null and searchKey!=''">
            LEFT JOIN xd_contacts t6 ON t1.resources_id = t6.resources_id
        </if>
        <where>
            t1.del_flag = 0
            <if test="sign != 2 and commerceId != null and commerceId !='' ">
                AND t1.commerce_id = #{commerceId,jdbcType=VARCHAR}
            </if>
            <if test="visitCity != null and visitCity!=''">
                AND t1.visit_city = #{visitCity,jdbcType=VARCHAR}
            </if>
            <if test="operationTypeId != null and operationTypeId !='' ">
                AND t1.operation_type_id IN
                <foreach collection="typeList" item="item" separator="," open="(" close=")">
                    #{item}
                </foreach>
            </if>
            <if test="firstTime != null">
                AND DATE_FORMAT(t1.first_time,'%Y-%m-%d') = DATE_FORMAT(#{firstTime},'%Y-%m-%d')
            </if>
            <if test="searchKey != null and searchKey!=''">
                AND (t1.business_code like "%"#{searchKey,jdbcType=VARCHAR}"%" OR t1.customer_name like "%"#{searchKey,jdbcType=VARCHAR}"%" OR t6.customer_name LIKE CONCAT('%',#{searchKey},'%'))
            </if>
            <if test="sign == 1 and resourcesStatus != null and resourcesStatus !=''">
                AND t1.resources_status IN
                <foreach collection="statuList" item="item" separator="," open="(" close=")">
                    CAST(#{item} AS SIGNED)
                </foreach>
            </if>
            <if test="sign == 0">
                AND t1.resources_status = 8
            </if>
            <if test="sign == 1 and (resourcesStatus == null or resourcesStatus == '' ) ">
                /*AND (t1.resources_status=1 OR t1.resources_status=2 OR t1.resources_status =3 OR t1.resources_status=4
                OR t1.resources_status=5 OR t1.resources_status=7)*/
                AND (t1.resources_status=1 OR t1.resources_status=2 OR t1.resources_status =3 OR t1.resources_status=7) AND (t1.current_visit_id IS NULL  OR t1.current_visit_id = '')
            </if>
            <if test="sign == 2">
                AND t1.resources_id IN (
                SELECT DISTINCT xrb.resources_id
                FROM xd_resources_base xrb
                WHERE xrb.del_flag = 0 AND xrb.resources_status = 6 AND xrb.lost_state = 1 AND t1.resources_id NOT IN (
                    SELECT DISTINCT xids.resources_id
                    FROM xd_is_display xids
                    WHERE xids.commerce_id = #{commerceId,jdbcType=VARCHAR}
                    <![CDATA[AND DATE_FORMAT(xids.end_time,'%Y-%m-%d %H:%i:%s') > DATE_FORMAT(NOW(),'%Y-%m-%d %H:%i:%s')]]>
                    )
                )
                AND t1.big_biz_id = (
                SELECT
                  big_biz_id
                FROM
                  xd_salesman
                WHERE
                  id = #{commerceId})
                AND t1.visit_city = (
                SELECT
                  city
                FROM
                  xd_salesman
                WHERE
                  id = #{commerceId}
                )
            </if>
            <if test="sign == 3 and resourcesStatus != null and resourcesStatus !=''">
                AND t1.resources_status IN
                <foreach collection="statuList" item="item" separator="," open="(" close=")">
                    CAST(#{item} AS SIGNED)
                </foreach>
                AND (t1.current_visit_id IS NULL  OR t1.current_visit_id = '')
            </if>
            <if test="sign == 4">
                AND (t7.source_code ='crm' OR t7.source_code ='jriboss' OR t7.source_code = 'iboss')
                AND (t1.current_visit_id IS NULL  OR t1.current_visit_id = '')
                AND(
                    (t1.resources_status IN (1, 2) AND TIMESTAMPDIFF(DAY,t1.assigner_time,NOW()) = #{notVisitDay})
                    OR(t1.resources_status IN(4,5) AND TIMESTAMPDIFF(DAY,t1.last_follow_time,NOW()) = #{afterOrderDay})
                    OR(t1.resources_status = 3 AND TIMESTAMPDIFF(DAY,t1.last_visit_time,NOW()) = #{afterVisitDay})
                )
                AND (
                    t1.last_follow_time IS NOT NULL
                    OR t1.last_visit_time IS NOT NULL
                )
            </if>
        </where>
        GROUP BY t1.resources_id
        <if test="sign != 4">
            ORDER BY t1.next_follow_time ASC
        </if>
        <if test="sign == 4">
            ORDER BY t1.last_follow_time,t1.last_visit_time ASC
        </if>
        <if test="page != null and pageSize != null">
            LIMIT #{page},#{pageSize}
        </if>
    </select>

    <!-- 通过条件查询统计总条数 -->
    <select id="selectCount" resultType="java.lang.Integer" parameterType="net.dgg.cloud.dto.XdResourcesBaseDto">
        select count(1)
        from xd_resources_base t1
        LEFT JOIN con_region t2 ON t1.visit_city =t2.id
        LEFT JOIN xd_business t3 ON t1.operation_type_id=t3.id
        LEFT JOIN xd_resources_status t4 ON t1.resources_status=t4.resource_status
        LEFT JOIN xd_resources_lostype t5 ON t1.lost_type=t5.lost_id
        LEFT JOIN xd_resource_source t7 ON t1.res_source_id = t7.id
        <if test="searchKey != null and searchKey!=''">
            LEFT JOIN xd_contacts t6 ON t1.resources_id = t6.resources_id
        </if>
        <where>
            t1.del_flag = 0
            <if test="sign != 2 and commerceId != null and commerceId !='' ">
                AND t1.commerce_id = #{commerceId,jdbcType=VARCHAR}
            </if>
            <if test="visitCity != null and visitCity!=''">
                AND t1.visit_city = #{visitCity,jdbcType=VARCHAR}
            </if>
            <if test="operationTypeId != null and operationTypeId !='' ">
                AND t1.operation_type_id IN
                <foreach collection="typeList" item="item" separator="," open="(" close=")">
                    #{item}
                </foreach>
            </if>
            <if test="firstTime != null">
                AND DATE_FORMAT(t1.first_time,'%Y-%m-%d') = DATE_FORMAT(#{firstTime},'%Y-%m-%d')
            </if>
            <if test="searchKey != null and searchKey!=''">
                AND (t1.business_code like "%"#{searchKey,jdbcType=VARCHAR}"%" OR t1.customer_name like "%"#{searchKey,jdbcType=VARCHAR}"%" OR t6.customer_name LIKE CONCAT('%',#{searchKey},'%'))
            </if>
            <if test="sign == 1 and resourcesStatus != null and resourcesStatus !=''">
                AND t1.resources_status IN
                <foreach collection="statuList" item="item" separator="," open="(" close=")">
                    CAST(#{item} AS SIGNED)
                </foreach>
            </if>
            <if test="sign == 0">
                AND t1.resources_status = 8
            </if>
            <if test="sign == 1 and resourcesStatus == null ">
                /*AND (t1.resources_status=1 OR t1.resources_status=2 OR t1.resources_status =3 OR t1.resources_status=4
                OR t1.resources_status=5 OR t1.resources_status=7)*/
                AND (t1.resources_status=1 OR t1.resources_status=2 OR t1.resources_status =3 OR t1.resources_status=7) AND (t1.current_visit_id IS NULL  OR t1.current_visit_id = '')
            </if>
            <if test="sign == 2">
                AND t1.resources_id IN (
                SELECT DISTINCT xrb.resources_id
                FROM xd_resources_base xrb
                WHERE xrb.del_flag = 0 AND xrb.resources_status = 6 AND xrb.lost_state = 1 AND t1.resources_id NOT IN (
                    SELECT DISTINCT xids.resources_id
                    FROM xd_is_display xids
                    WHERE xids.commerce_id = #{commerceId,jdbcType=VARCHAR}
                    <![CDATA[AND DATE_FORMAT(xids.end_time,'%Y-%m-%d %H:%i:%s') > DATE_FORMAT(NOW(),'%Y-%m-%d %H:%i:%s')]]>
                  )
                )
                AND t1.operation_type_id = (
                SELECT
                  big_biz_id
                FROM
                  xd_salesman
                WHERE
                id = #{commerceId})
                AND t1.visit_city = (
                SELECT
                  city
                FROM
                  xd_salesman
                WHERE
                  id = #{commerceId}
                )
            </if>
            <if test="sign == 3 and resourcesStatus != null and resourcesStatus !=''">
                AND t1.resources_status IN
                <foreach collection="statuList" item="item" separator="," open="(" close=")">
                    CAST(#{item} AS SIGNED)
                </foreach>
                AND (t1.current_visit_id IS NULL  OR t1.current_visit_id = '')
            </if>
            <if test="sign == 4">
                AND (t7.source_code ='crm' OR t7.source_code ='jriboss' OR t7.source_code = 'iboss')
                AND (t1.current_visit_id IS NULL  OR t1.current_visit_id = '')
                AND(
                    (t1.resources_status IN (1, 2) AND TIMESTAMPDIFF(DAY,t1.assigner_time,NOW()) = #{notVisitDay})
                    OR(t1.resources_status IN(4,5) AND TIMESTAMPDIFF(DAY,t1.last_follow_time,NOW()) = #{afterOrderDay})
                    OR(t1.resources_status = 3 AND TIMESTAMPDIFF(DAY,t1.last_visit_time,NOW()) = #{afterVisitDay})
                )
                AND (
                t1.last_follow_time IS NOT NULL
                OR t1.last_visit_time IS NOT NULL
                )
            </if>
        </where>
    </select>

    <!-- 修改下次跟进时间 -->
    <update id="updateNextTimeByResourcesId" parameterType="net.dgg.cloud.entity.XdResourcesBase">
    update xd_resources_base
    set
    next_follow_time = #{nextFollowTime,jdbcType=TIMESTAMP},
    create_user_id = #{createUserId,jdbcType=VARCHAR},
    create_time = #{createTime,jdbcType=TIMESTAMP},
    update_user_id = #{updateUserId,jdbcType=VARCHAR},
    update_time = #{updateTime,jdbcType=TIMESTAMP}
    where resources_id = #{resourcesId,jdbcType=VARCHAR}
  </update>

    <resultMap id="ResultMap" type="net.dgg.cloud.dto.XdResourcesBaseInfoDto">
        <id column="resources_id" property="resourcesId" jdbcType="VARCHAR"/>
        <result column="business_code" property="businessCode" jdbcType="VARCHAR"/>
        <result column="customer_name" property="customerName" jdbcType="VARCHAR"/>
        <result column="customer_phone" property="customerPhone" jdbcType="VARCHAR"/>
        <result column="customer_sex" property="customerSex" jdbcType="INTEGER"/>
        <result column="business_name" property="businessName" jdbcType="VARCHAR"/>
        <result column="name" property="visitCityName" jdbcType="VARCHAR"/>
        <result column="customer_address" property="customerAddress" jdbcType="VARCHAR"/>
        <result column="visit_address" property="visitAddress" jdbcType="VARCHAR"/>
        <result column="message" property="message" jdbcType="VARCHAR"/>
        <result column="resources_status" property="resourcesStatus" jdbcType="INTEGER"/>
        <result column="status_name" property="statusName" jdbcType="VARCHAR"/>
        <result column="first_time" property="firstTime" jdbcType="TIMESTAMP"/>
        <result column="lost_time" property="lostTime" jdbcType="TIMESTAMP"/>
        <result column="lost_type" property="lostType" jdbcType="INTEGER"/>
        <result column="lost_name" property="lostName" jdbcType="VARCHAR"/>
        <result column="longitude" property="longitude" jdbcType="VARCHAR"/>
        <result column="latitude" property="latitude" jdbcType="VARCHAR"/>
        <result column="next_follow_time" property="nextFollowTime" jdbcType="VARCHAR"/>
        <result column="assigner_time" property="assignerTime" jdbcType="TIMESTAMP"/>
        <result column="resource_channel" property="resourceChannel" jdbcType="INTEGER"/>
        <result column="invalid_num" property="invalidNum" jdbcType="INTEGER"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="current_visit_id" property="currentVisitId" jdbcType="VARCHAR"/>
        <result column="last_follow_time" property="lastFollowTime" jdbcType="TIMESTAMP"/>
        <result column="last_visit_time" property="lastVisitTime" jdbcType="TIMESTAMP"/>
        <result column="channel_code" property="channelCode" jdbcType="VARCHAR"/>
    </resultMap>
    <sql id="Column_List">
    t1.resources_id, business_code, t1.customer_name,
	customer_phone, customer_sex, t3.business_name AS business_name,t2.name AS `name`,
    t1.customer_address, visit_address, consulting_time, subscribe_time,
    message,resources_status, t4.status_name,first_time, next_follow_time AS lost_time,
    lost_type,t5.lost_name,t1.longitude, t1.latitude, next_follow_time, assigner_time ,resource_channel, invalid_num,
    t1.create_time, t1.current_visit_id, t1.last_follow_time, t1.last_visit_time, t7.source_code AS channel_code
  </sql>

    <resultMap id="OneResultMap" type="net.dgg.cloud.dto.XdResourcesBaseOneDto">
        <id column="resources_id" property="resourcesId" jdbcType="VARCHAR"/>
        <result column="business_code" property="businessCode" jdbcType="VARCHAR"/>
        <result column="customer_name" property="customerName" jdbcType="VARCHAR"/>
        <result column="customer_phone" property="customerPhone" jdbcType="VARCHAR"/>
        <result column="first_time" property="firstTime" jdbcType="TIMESTAMP"/>
        <result column="next_follow_time" property="nextFollowTime" jdbcType="TIMESTAMP"/>
        <result column="business_name" property="businessName" jdbcType="VARCHAR"/>
        <result column="resource_channel" property="resourceChannel" jdbcType="VARCHAR"/>
        <result column="channel_code" property="channelCode" jdbcType="VARCHAR"/>
    </resultMap>
    <sql id="Column_One">
        resources_id, business_code, customer_name,
        customer_phone, first_time, next_follow_time,business_name,xrs.source_name AS resource_channel, xrs.source_code AS channel_code
    </sql>

    <!-- 通过资源id获取信息 -->
    <select id="selectResourcesById" resultMap="OneResultMap" parameterType="java.lang.String">
        select
        <include refid="Column_One"/>
        from xd_resources_base t1
        LEFT JOIN xd_business t2 on t1.operation_type_id=t2.id
        LEFT JOIN xd_resource_source xrs ON t1.res_source_id = xrs.id
        where t1.resources_id = #{resourcesId,jdbcType=VARCHAR}
    </select>

    <!-- 统计待处理量 -->
    <select id="selectPendingCountByMonth" parameterType="java.lang.String" resultType="int">
        SELECT COUNT(1)
        FROM xd_resources_base
        WHERE commerce_id = #{salesmanId} AND del_flag = 0
        AND ( resources_status = 1 OR resources_status = 2 OR resources_status = 3 OR  resources_status = 4)
    </select>

    <!-- 获取未响应数量 -->
    <select id="selectBySalesmanAndState8" resultType="int" parameterType="map">
        SELECT COUNT(1)
        FROM xd_resources_base
        WHERE resources_status = 8 AND del_flag = 0
        AND commerce_id = #{salesmanId} AND resources_id = #{resourceId}
    </select>

    <resultMap id="WXResourcesResult" type="net.dgg.cloud.dto.XdWxResourceBaseDto">
        <id column="resources_id" property="resourceId" jdbcType="VARCHAR"/>
        <result column="business_code" property="businessCode" jdbcType="VARCHAR"/>
        <result column="customer_name" property="customerName" jdbcType="VARCHAR"/>
        <result column="customer_phone" property="customerPhone" jdbcType="VARCHAR"/>
        <result column="business_name" property="businessName" jdbcType="VARCHAR"/>
        <result column="assigner_time" property="assignerTime" jdbcType="TIMESTAMP"/>
        <result column="resources_status" property="resourcesStatus" jdbcType="INTEGER"/>
        <result column="next_follow_time" property="nextFollowTime" jdbcType="TIMESTAMP"/>
        <result column="salesman_phone" property="salesmanPhone" jdbcType="VARCHAR"/>
    </resultMap>

    <!-- 电话查询资源 -->
    <select id="selectResourcesListByPhone" resultMap="WXResourcesResult" parameterType="net.dgg.cloud.dto.WxUserDto">
        SELECT
        resources_id,
        business_code,
        customer_name,
        customer_phone,
        business_name,
        assigner_time,
        resources_status,
        t3.`name` AS salesmanName,
        t3.phone_number AS salesman_phone,
        next_follow_time
        FROM
        xd_resources_base t1
        LEFT JOIN xd_business t2 ON t1.operation_type_id = t2.id
        LEFT JOIN xd_salesman t3 ON t1.commerce_id = t3.id
        WHERE
        customer_phone = #{phoneNo}
        AND t1.del_flag = 0 AND (resources_status = 1 OR resources_status = 2 OR resources_status = 3 OR resources_status = 4 OR resources_status = 5)
        <if test="page != null and pageSize != null">
            Limit #{page},#{pageSize}
        </if>
    </select>

    <!-- 电话查询资源统计 -->
    <select id="selectResourcesCountByPhone" resultType="int" parameterType="java.lang.String">
        SELECT COUNT(1)
        FROM
            xd_resources_base t1
        LEFT JOIN xd_business t2 ON t1.operation_type_id = t2.id
        WHERE
            customer_phone = #{phoneNo}
        AND t1.del_flag = 0 AND (resources_status = 1 OR resources_status = 2 OR resources_status = 3 OR resources_status = 4 OR resources_status = 5)
    </select>

    <select id="selectOrderCountByMonth" resultType="int" parameterType="string">
    SELECT IFNULL(count(xdrb.resources_id),0)
    FROM xd_resources_base as xdrb
    WHERE xdrb.commerce_id = #{salesmanId} and xdrb.resources_status=5 and
    DATE_FORMAT(place_time,'%Y%M') = DATE_FORMAT(NOW(),'%Y%M')
    </select>

    <select id="selectByPhoneAndTypeId" parameterType="string" resultMap="BaseResultMap">
        select resources_id , resources_status FROM
        xd_resources_base t where t.customer_phone = #{param1,jdbcType=VARCHAR} and t.operation_type_id = #{param2,jdbcType=VARCHAR} and del_flag = 0
    </select>

    <select id="selectVisitingResource" parameterType="string" resultMap="BaseResultMap">
        SELECT
            <include refid="Base_Column_List" />
        FROM
            xd_resources_base
        WHERE
            commerce_id = #{salesmanId}
        AND resources_status NOT IN (6,7,10)
        AND (current_visit_id IS NOT NULL OR current_visit_id != '')
    </select>

    <!-- 当前上门资源 -->
    <select id="selectCurrentVisitResource" resultMap="ResultMap" parameterType="java.lang.String">
        select
        <include refid="Column_List"/>
        from xd_resources_base t1
        LEFT JOIN con_region t2 ON t1.visit_city =t2.id
        LEFT JOIN xd_business t3 ON t1.operation_type_id=t3.id
        LEFT JOIN xd_resources_status t4 ON t1.resources_status=t4.resource_status
        LEFT JOIN xd_resources_lostype t5 ON t1.lost_type=t5.lost_id
        LEFT JOIN xd_resource_source t7 ON t1.res_source_id = t7.id
        WHERE t1.commerce_id = #{salesmanId} AND t1.del_flag = 0 AND t1.resources_status NOT IN (6,7,10) AND (t1.current_visit_id IS NOT NULL OR t1.current_visit_id != '')
    </select>

</mapper>